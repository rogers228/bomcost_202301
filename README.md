# 2023/1月 重新建構bom製程 成本表 程式

## 系統架構
1. 發布時同步至nas
2. 採分散式架構，由使用者工作站執行
3. 採用Gui介面，Excel輸出

## 功能選項
1. 輸入品號後，產出BOM 製程成本表
2. 可選項，泵浦不展階
3. 自動製表並檢查、提示、試算

## 欄位抓取
|  欄位   |  抓取 |
|  ----  | ---- |
|序號    |  系統自動計算，相同零件多品號時為同一序號
|品號    |  品號建立作業, 品號MB001
|品名規格| 品號建立作業, 品名MB002, 規格MB003
|品名屬性|  品號建立作業, 屬性MB025
|BOM階數 |  BOM用量建立作業, 條件品號為0階
|用量底數|  BOM用量建立作業, 用量MD006, 底數MD007
|換算單位|  品號建立作業單位換算
|單價    |    統一換算為PCS單價
|固定人時 | 僅自製加工件時顯示
|固定機時 | 僅自製加工件時顯示
|工時批量 | 僅自製加工件時顯示
|總用量  | 該零件在0階品號用量為1PCS時所需要的用量，固定換算為PCS
|總單價  | 該零件(相同序號)的總單價，固定換算為PCS
|金額    | 總用量*總單價
|試算    | 依照零件序號，逐行金額加總

## 特殊條件欄位抓取
|  欄位   | 條件  | 抓取 |
|  ----  | ----  | ---- |
|廠商     | 採購件P     | 品號建立作業單位換算, 主供應商MB032
|        | 加工件M,S,Y     | 產品途程建立作業, 供應商MF006
|        | 銷售件Q | 固定為'YEOSEH'
|製程     | 採購件P     | 固定為'採購'
|        | 加工件M,S,Y     | 產品途程建立作業, 製程MW002
|        | 銷售件Q | 固定為'銷售'
|製程敘述 | 採購件P     | 無
|        | 加工件M,S,Y     | 產品途程建立作業, 製程敘述MF008
|        | 銷售件Q | 無
|單位     | 採購件P     | 第一順位採購單位MB155,第二順位庫存單位MB004
|        | 加工件M,S,Y | 加工單位MF017
|        | 銷售件Q | 銷售單位MB156
|製程單價 | 泵浦(品號6AA開頭 & 不展階) | 售價MB053
|         | 採購件P | 第一順位最新進價(本國幣別NTD)MB050, 第二順位品號廠商採購單價
|         | 加工件M,S,Y & 1自製 | 產品途程備註 MF023
|         | 加工件M,S,Y & 2托外 | 第一順位產品途程加工單價 MF018, 第二順位加工計價資料

## 資料檢查
系統將自動檢查，符合以下者代表錯誤，將高亮度顯示

|  欄位   | 檢查條件  | 結果 | 備註 |
|  ----  | ----  | ---- |---- |
|品號屬性 | P件不應該有BOM架構，或有BOM應為S件or M件 | 黃 |
|BOM階層 | 最下階應為P, Q件，或應再建立P件為子件 | 黃 |
|換算單位| 加工件M,S,Y途程加工單位是PCS以外的單位卻無換算單位 | 黃 |
|        | 採購件P採購計價單位是PCS以外的單位卻無換算單位 | 黃 |
|        | 採購件P採購計價單位是PCS以外的單位，有單位換算卻不符合最新進貨 | 黃 |
|        | 採購件P採購單位與最新計價單位皆為PCS，卻有設定換算單位 | 橘 |
|廠商簡稱| 供應商已禁止交易| 黃
|        | 連續最後三次採購進貨者，提示更新為主供應商| 橘
|單位    | 加工件M,S,Y單位&不符合標準途程加工單位| 黃 | 產品途程作業92N001-02
|        | 採購件P單位&不符合標準廠商採購計價單位| 黃 | (第一順位)產品途程作業92N001-03
|        | 採購件P單位&不符合最新採購進貨計價單位| 黃 | (第二順位)
|製程單價 | 未維護為0者 | 黃 |
|        | 加工件M,S,Y單價不符合標準廠商途程加工單價| 黃 | (第一順位)產品途程作業92N001-01
|        | 加工件M,S,Y單價未更新托外進貨單價| 橘 | (第二順位)
|        | 採購件P單價未更新採購進價| 橘 |

## 試算
1. 試算零件成本逐個加總金額
2. 試算材料KG單價